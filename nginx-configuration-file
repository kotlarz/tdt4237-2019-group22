server {
	listen 4022;
	index index.html;

	location / {
		proxy_redirect off;
		proxy_set_header Host 127.0.0.1;
		proxy_pass http://sec:8022;
	}

	location /static/ {
		root /home/www-data/group22/;
	}

	location /media/ {
		root /home/www-data/group22/;
		
		# FIXME: Malicious file uploads - Remove this location block
        # When accessing either a bash file or a python file that has been uploaded,
        # the file will be executed. This allows for arbitrary code execution 
        # on the server. Which may allow root access to the server to privilege
        # escalation on the server.
		location ~ (\.py|\.sh) {
			gzip off;
			fastcgi_pass unix:/var/run/fcgiwrap.socket;
			include /etc/nginx/fastcgi_params;
			fastcgi_param SCRIPT_FILENAME /home/www-data/group22/$fastcgi_script_name;
		}
	}
}
